displayName: Container Vulnerability Detected
combiner: OR
conditions:
  - conditionThreshold:
      aggregations:
        - alignmentPeriod: 60s
          crossSeriesReducer: REDUCE_COUNT
          groupByFields:
            - metric.label.image
          perSeriesAligner: ALIGN_COUNT
      comparison: COMPARISON_GT
      duration: 60s
      filter: metric.type="logging.googleapis.com/user/container-vulnerability" resource.type="cloud_function"
      trigger:
        count: 1
    displayName: Container Vulnerability by Image [COUNT]
documentation:
  content: Container Image ${metric.label.image} has N vulnerabilities!
  mimeType: text/markdown
enabled: true